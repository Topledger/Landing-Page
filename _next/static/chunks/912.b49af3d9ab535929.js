"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[912],{40912:function(a,b,c){c.r(b),c.d(b,{default:function(){return p}});var d=c(87472),e=c(67294),f=c(73935),g=c(45305),h=c(50462),i=c(73074),j=c(42710);c(97762),c(11176);var k=function(){var a=(arguments.length>0&& void 0!==arguments[0]?arguments[0]:{}).cleanupDelay,b={},c=(0,d.N)(function(){(0,d.e)(b,function(a,c){a.refCount<=0&&delete b[c]})},void 0===a?2e3:a);return{get:function(a,c){b[a]||(b[a]={value:c(),refCount:0});var d=b[a];return d.refCount+=1,d.value},release:function(a){if(b[a]){var d=b[a];d.refCount>0&&(d.refCount-=1,d.refCount<=0&&c())}}}}();function l(a,b,c){var e=a.properties[c];if((0,d.l)(e)&&(0,d.a)(b[e]))return b[e].value}function m(a){var b=a.items,c=a.alignText;return e.createElement("div",{className:"choropleth-visualization-legend"},(0,d.n)(b,function(a,b){return e.createElement("div",{key:"legend".concat(b),className:"legend-item"},e.createElement("div",{className:"legend-item-text text-".concat(c)},a.text))}))}m.defaultProps={items:[],alignText:"left"};var n=g.L.Control.extend({options:{position:"topright"},onAdd:function(){var a=document.createElement("div");return a.className="leaflet-bar leaflet-custom-toolbar",a.style.background="#fff",a.style.backgroundClip="padding-box",a},onRemove:function(){f.unmountComponentAtNode(this.getContainer())}});function o(a,b){return a&&(a=g.L.latLngBounds(a[0],a[1])).isValid()?a:b&&b.isValid()?b:null}function p(a){var b,c,p,q,r,s,t,u,v,w=a.data,x=a.options,y=a.onOptionsChange,z=(0,e.useState)(null),A=(0,d.D)(z,2),B=A[0],C=A[1],D=(b=x.mapType,c=(0,e.useState)(null),q=(p=(0,d.D)(c,2))[0],r=p[1],s=(0,e.useState)(!1),t=(0,d.D)(s,2),u=t[0],v=t[1],(0,e.useEffect)(function(){var a=(0,d.O)(d.K,"choroplethAvailableMaps.".concat(b,".url"),void 0);if("function"==typeof a){v(!0);var c=!1;return a().then(function(a){c||(r((0,d.a)(a)?a:null),v(!1))}),function(){c=!0}}if((0,d.l)(a)){v(!0);var e=!1;return k.get(a,function(){return d.P.get(a).catch(function(){return null})}).then(function(a){var b=a.data;e||(r((0,d.a)(b)?b:null),v(!1))}),function(){e=!0,k.release(a)}}(0,d.a)(a)?(r(a),v(!1)):(r(null),v(!1))},[b]),[q,u]),E=(0,d.D)(D,1)[0],F=(0,e.useRef)();F.current=y?function(a){return y((0,d._)((0,d._)({},x),{},{bounds:a}))}:d.U;var G,H,I,J,K=(G=function(){return(0,d.V)(x,["bounds"])},H=[x],I=(0,e.useRef)(),J=(0,e.useMemo)(G,H),(0,d.M)(J,I.current)||(I.current=J),I.current),L=(0,e.useState)(null),M=(0,d.D)(L,2),N=M[0],O=M[1];return(0,e.useEffect)(function(){if(B){var a=function(a,b){var c=g.L.map(a,{center:[0,0],zoom:1,zoomSnap:0,scrollWheelZoom:!1,maxBoundsViscosity:1,attributionControl:!1,fullscreenControl:!0}),k=null,p=new n,q=!1,r=function(){!function(){if((0,d.I)(b)){var a=c.getBounds();b([[a._southWest.lat,a._southWest.lng],[a._northEast.lat,a._northEast.lng]])}}()};c.on("focus",function(){q=!0,c.on("moveend",r)}),c.on("blur",function(){c.off("moveend",r),q=!1});var s=(0,i.o)(a,function(){c.invalidateSize(!1)});return{updateLayers:function(a,b,i){if(c.eachLayer(function(a){return c.removeLayer(a)}),c.removeControl(p),!(0,d.a)(a)||!(0,d.F)(a.features))return k=null,void c.setMaxBounds(null);var n,q,r,s=function(a,b,c){var e=(0,d.u)((0,d.x)((0,d.n)(a,function(a){return l(a,b,c.targetField)}),d.Q));if(0===e.length)return{limits:[],colors:[],legend:[]};var f=Math.min(e.length,c.steps);if(1===f)return{limits:e,colors:[c.colors.max],legend:[{color:c.colors.max,limit:(0,d.S)(e)}]};var g=j.c.limits(e,c.clusteringMode,f-1),h=j.c.scale([c.colors.min,c.colors.max]).colors(g.length),i=(0,d.n)(h,function(a,b){return{color:a,limit:g[b]}}).reverse();return{limits:g,colors:h,legend:i}}(a.features,b,i),t=s.limits,u=s.colors,v=s.legend,w=(n=i.valueFormat,q=i.noValuePlaceholder,r=(0,h.c)(n),function(a){return(0,d.Q)(a)?r(a):q}),x=(k=g.L.geoJSON(a,{onEachFeature:function(a,c){var e,f,g,k,m,n,o,p,q,r,s,v,x,y,z,A,B;p=(e={feature:a,layer:c,data:b,options:i,limits:t,colors:u,formatValue:w}).feature,q=e.layer,r=e.data,s=e.options,v=e.limits,x=e.colors,y=e.formatValue,z=l(p,r,s.targetField),A=(f=p,g=y(z),k=r,m=s.targetField,n={},(0,d.e)(f.properties,function(a,b){n["@@"+b]=a}),n["@@value"]=g,o=k[f.properties[m]]||{},(0,d.o)(n,o.item)),B=function(a,b,c,e){if((0,d.Q)(a)){for(var f=0;f<b.length;f+=1)if(a<=b[f])return c[f]}return e}(z,v,x,s.colors.noValue),q.setStyle({color:s.colors.borders,weight:1,fillColor:B,fillOpacity:1}),s.tooltip.enabled&&q.bindTooltip((0,d.T)((0,h.f)(s.tooltip.template,A)),{sticky:!0}),s.popup.enabled&&q.bindPopup((0,d.T)((0,h.f)(s.popup.template,A))),q.on("mouseover",function(){var a;q.setStyle({weight:2,fillColor:(a=B,(0,j.c)(a).darken().hex())})}),q.on("mouseout",function(){q.setStyle({weight:1,fillColor:B})})}}).addTo(c)).getBounds(),y=o(i.bounds,x);c.fitBounds(y,{animate:!1,duration:0}),c.options.maxBounds=x,c.panInsideBounds(x,{animate:!1,duration:0}),i.legend.visible&&v.length>0&&(p.setPosition(i.legend.position.replace("-","")),c.addControl(p),f.render(e.createElement(m,{items:(0,d.n)(v,function(a){return(0,d._)((0,d._)({},a),{},{text:w(a.limit)})}),alignText:i.legend.alignText}),p.getContainer()))},updateBounds:function(a){q||(a=o(a,k?k.getBounds():c.getBounds()))&&c.fitBounds(a,{animate:!1,duration:0})},destroy:function(){s(),c.removeControl(p),c.remove()}}}(B,function(){return F.current.apply(F,arguments)});return O(a),function(){a.destroy()}}},[B]),(0,e.useEffect)(function(){N&&N.updateLayers(E,function(a,b,c){if(!b||!c)return{};var e={};return(0,d.e)(a,function(a){if(a[b]){var f=parseFloat(a[c]);e[a[b]]={code:a[b],value:(0,d.Q)(f)?f:void 0,item:a}}}),e}(w.rows,K.keyColumn,K.valueColumn),x)},[N,E,w.rows,K]),(0,e.useEffect)(function(){N&&N.updateBounds(x.bounds)},[N,x,y]),e.createElement("div",{className:"map-visualization-container",style:{background:x.colors.background},ref:C})}(0,d.d)(".choropleth-visualization-legend {\n  padding: 3px;\n  cursor: default;\n}\n.choropleth-visualization-legend > div {\n  line-height: 1;\n  margin: 5px;\n}\n.choropleth-visualization-legend .legend-item {\n  display: flex;\n  align-items: center;\n}\n.choropleth-visualization-legend .legend-item .color-swatch {\n  margin-right: 5px;\n}\n.choropleth-visualization-legend .legend-item .legend-item-text {\n  flex: 1 1 auto;\n}\n.choropleth-visualization-legend .legend-item .legend-item-text.text-left {\n  text-align: left;\n}\n.choropleth-visualization-legend .legend-item .legend-item-text.text-center {\n  text-align: center;\n}\n.choropleth-visualization-legend .legend-item .legend-item-text.text-right {\n  text-align: right;\n}\n"),p.propTypes=d.R},73074:function(a,b,c){c.d(b,{o:function(){return f}});var d=new Map;function e(){d.size>0&&(d.forEach(function(a,b){var c=b.getBoundingClientRect(),d=Math.round(10*c.width),e=Math.round(10*c.height);a.width===d&&a.height===e||(a.width=d,a.height=e,a.callback(b))}),setTimeout(e,100))}function f(a,b){if(a&&!d.has(a)){var c=0===d.size;return d.set(a,{callback:b}),c&&e(),function(){return d.delete(a)}}return function(){}}}}])