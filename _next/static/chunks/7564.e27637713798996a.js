"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7564,9826],{7564:function(a,b,c){c.r(b),c.d(b,{default:function(){return j}});var d=c(4216),e=c(7294),f=c(9826),g=c(5078);function h(a){return a.y+a.dy/2}function i(a){return a.value}function j(a){var b=a.data,c=(0,e.useState)(null),j=(0,d._)(c,2),k=j[0],l=j[1],m=(0,e.useMemo)(function(){return function(a){if(a.rows=(c=a.rows,d.l.map(c,function(a){return d.l.mapValues(a,function(a){return!a||d.l.isNumber(a)||d.l.isNaN(parseFloat(a))?a:parseFloat(a)})})),!(!(!(b=a)||!d.l.find(b.columns,function(a){return"value"===a.name}))&&d.l.every(b.rows,function(a){return d.l.every(a,function(a){return!(a&&!d.l.isString(a))||isFinite(a)})})))return function(a){g.select(a).selectAll("*").remove()};a=function(a){var b={},c={},e=[],f=d.l.sortBy(d.l.filter(d.l.keys(a[0]),function(a){return"value"!==a}),d.l.identity);function h(a,c){a=(f=a,d.l.isNil(f)?"Exit":""+f);var f,g="".concat(a,":").concat(String(c)),h=b[g];return h||((h={name:a}).id=e.push(h)-1,b[g]=h),h}function i(a,b,d,e){if(""!==a&&a||!(e>1)){var f,g,i,j=h(a,e),k=h(b,e+1),l=(f=j.id,(i=c[[f,g=k.id]])||(i={target:g,source:f,value:0},c[[f,g]]=i),i);l.value+=parseInt(d,10)}}a.forEach(function(a){i(a[f[0]],a[f[1]],a.value||0,1),i(a[f[1]],a[f[2]],a.value||0,2),i(a[f[2]],a[f[3]],a.value||0,3),i(a[f[3]],a[f[4]],a.value||0,4),i(a[f[4]],null,a.value||0,5)});var j=g.scale.category20();return{nodes:d.l.map(e,function(a){return d.l.extend(a,{color:j(a.name.replace(/ .*/,""))})}),links:d.l.values(c)}}(a.rows);var b,c,e=function(a){return g.format(",.0f")(a)};return function(b){g.select(b).selectAll("*").remove();var c=10,f=10,j=10,k=10,l=b.offsetWidth-k-f,m=b.offsetHeight-c-j;if(!(l<=0||m<=0)){var n=g.select(b).append("svg").attr("class","sankey").attr("width",l+k+f).attr("height",m+c+j).append("g").attr("transform","translate(".concat(k,",").concat(c,")")),o=(function(){var a={},b=24,c=8,d=[1,1],e=[],f=[];function j(){function a(a,b){return a.source.y-b.source.y}function b(a,b){return a.target.y-b.target.y}e.forEach(function(c){c.sourceLinks.sort(b),c.targetLinks.sort(a)}),e.forEach(function(a){var b=0,c=0;a.sourceLinks.forEach(function(a){a.sy=b,b+=a.dy}),a.targetLinks.forEach(function(a){a.ty=c,c+=a.dy})})}return a.nodeWidth=function(c){return arguments.length?(b=+c,a):b},a.nodePadding=function(b){return arguments.length?(c=+b,a):c},a.nodes=function(b){return arguments.length?(e=b,a):e},a.links=function(b){return arguments.length?(f=b,a):f},a.size=function(b){return arguments.length?(d=b,a):d},a.layout=function(k){return e.forEach(function(a){a.sourceLinks=[],a.targetLinks=[]}),f.forEach(function(a){var b=a.source,c=a.target;"number"==typeof b&&(b=a.source=e[a.source]),"number"==typeof c&&(c=a.target=e[a.target]),b.sourceLinks.push(a),c.targetLinks.push(a)}),e.forEach(function(a){a.value=Math.max(g.sum(a.sourceLinks,i),g.sum(a.targetLinks,i))}),function(){var a,c,f,h=e,i=0;function j(a){a.x=i,a.dx=b,a.sourceLinks.forEach(function(a){0>c.indexOf(a.target)&&c.push(a.target)})}for(;h.length;)c=[],h.forEach(j),h=c,i+=1;a=i,e.forEach(function(b){b.sourceLinks.length||(b.x=a-1)}),i=Math.max(g.max(e,function(a){return a.x}),2),f=(d[0]-b)/(i-1),e.forEach(function(a){a.x*=f})}(),function(a){var b,j=g.nest().key(function(a){return a.x}).sortKeys(g.ascending).entries(e).map(function(a){return a.values});function k(a){function b(a){return h(a.source)*a.value}j.forEach(function(c){c.forEach(function(c){if(c.targetLinks.length){var d=g.sum(c.targetLinks,b)/g.sum(c.targetLinks,i);c.y+=(d-h(c))*a}})})}function l(){j.forEach(function(a){var b,e,f,g=a.length,h=0;for(a.sort(o),f=0;f<g;++f)(e=h-(b=a[f]).y)>0&&(b.y+=e),h=b.y+b.dy+c;if((e=h-c-d[1])>0)for(h=b.y-=e,f=g-2;f>=0;--f)(e=(b=a[f]).y+b.dy+c-h)>0&&(b.y-=e),h=b.y})}b=g.min(j,function(a){return(d[1]-(a.length-1)*c)/g.sum(a,i)}),j.forEach(function(a){a.forEach(function(a,c){a.y=c,a.dy=a.value*b})}),f.forEach(function(a){a.dy=a.value*b}),l();for(var m=1;a>0;a-=1)n(m*=.99),l(),k(m),l();function n(a){function b(a){return h(a.target)*a.value}j.slice().reverse().forEach(function(c){c.forEach(function(c){if(c.sourceLinks.length){var d=g.sum(c.sourceLinks,b)/g.sum(c.sourceLinks,i);c.y+=(d-h(c))*a}})})}function o(a,b){return a.y-b.y}}(k),j(),a},a.relayout=function(){return j(),a},a.link=function(){var a=arguments,b=.5;function c(a){var c=a.source.x+a.source.dx,d=a.target.x,e=g.interpolateNumber(c,d),f=e(b),h=e(1-b),i=a.source.y+a.sy+a.dy/2,j=a.target.y+a.ty+a.dy/2;return"M".concat(c,",").concat(i,"C").concat(f,",").concat(i," ").concat(h,",").concat(j," ").concat(d,",").concat(j)}return c.curvature=function(d){return a.length?(b=+d,c):b},c},a})().nodeWidth(15).nodePadding(10).size([l,m]),p=o.link();o.nodes(a.nodes).links(a.links).layout(0),function(a,b){g.nest().key(function(a){return a.x}).entries(b.nodes).map(function(a){return a.values}).forEach(function(b){b=d.l.filter(d.l.sortBy(b,function(a){return-a.value}),function(a){return"Exit"!==a.name});var c=g.sum(b,function(a){return a.dy}),e=(a-c)/b.length;d.l.reduce(b,function(a,b){return b.y=a,a+b.dy+e},0)})}(m,a),o.relayout();var q=n.append("g").selectAll(".link").data(a.links).enter().append("path").filter(function(a){return"Exit"!==a.target.name}).attr("class","link").attr("d",p).style("stroke-width",function(a){return Math.max(1,a.dy)}).sort(function(a,b){return b.dy-a.dy});q.append("title").text(function(a){return"".concat(a.source.name," â†’ ").concat(a.target.name,"\n").concat(e(a.value))});var r=n.append("g").selectAll(".node").data(a.nodes).enter().append("g").filter(function(a){return"Exit"!==a.name}).attr("class","node").attr("transform",function(a){return"translate(".concat(a.x,",").concat(a.y,")")});r.on("mouseover",function(a){var b,c,e=(b=a,console.log(b),c=[],b.sourceLinks.forEach(function(a){c.push(a.target)}),b.targetLinks.forEach(function(a){c.push(a.source)}),c);e=d.l.map(e,function(a){return a.id}),r.filter(function(b){return b!==a&&!d.l.includes(e,b.id)}).style("opacity",.2),q.filter(function(b){return!(d.l.includes(a.sourceLinks,b)||d.l.includes(a.targetLinks,b))}).style("opacity",.2)}).on("mouseout",function(){r.style("opacity",1),q.style("opacity",1)}),r.append("rect").attr("height",function(a){return a.dy}).attr("width",o.nodeWidth()).style("fill",function(a){return a.color}).style("stroke",function(a){return g.rgb(a.color).darker(2)}).append("title").text(function(a){return"".concat(a.name,"\n").concat(e(a.value))}),r.append("text").attr("x",-6).attr("y",function(a){return a.dy/2}).attr("dy",".35em").attr("text-anchor","end").attr("transform",null).text(function(a){return a.name}).filter(function(a){return a.x<l/2}).attr("x",6+o.nodeWidth()).attr("text-anchor","start")}}}(b)},[b]);return(0,e.useEffect)(function(){if(k)return m(k),(0,f.o)(k,function(){m(k)})},[k,m]),e.createElement("div",{className:"sankey-visualization-container",ref:l})}c(3935),c(7762),(0,d.s)("/* Sankey Visualization */\n.sankey .node rect {\n  fill-opacity: 0.9;\n  shape-rendering: crispEdges;\n  stroke-width: 0;\n}\n.sankey .node text {\n  text-shadow: 0 1px 0 #fff;\n}\n.sankey .link {\n  fill: none;\n  stroke: #000;\n  stroke-opacity: 0.2;\n}\n.sankey-visualization-container {\n  height: 500px;\n  overflow: hidden;\n}\n"),j.propTypes=d.R},9826:function(a,b,c){c.d(b,{o:function(){return f}});var d=new Map;function e(){d.size>0&&(d.forEach(function(a,b){var c=b.getBoundingClientRect(),d=Math.round(10*c.width),e=Math.round(10*c.height);a.width===d&&a.height===e||(a.width=d,a.height=e,a.callback(b))}),setTimeout(e,100))}function f(a,b){if(a&&!d.has(a)){var c=0===d.size;return d.set(a,{callback:b}),c&&e(),function(){return d.delete(a)}}return function(){}}}}])