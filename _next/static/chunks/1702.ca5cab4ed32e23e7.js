"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1702],{41702:function(a,b,c){c.r(b),c.d(b,{default:function(){return o}});var d=c(50956),e=c(67294),f=c(73935),g=c(79932),h=c(59826),i=c(92929);c(61920),c(97762);var j=function(){var a=(arguments.length>0&& void 0!==arguments[0]?arguments[0]:{}).cleanupDelay,b={},c=d.l.debounce(function(){d.l.each(b,function(a,c){a.refCount<=0&&delete b[c]})},void 0===a?2e3:a);return{get:function(a,c){b[a]||(b[a]={value:c(),refCount:0});var d=b[a];return d.refCount+=1,d.value},release:function(a){if(b[a]){var d=b[a];d.refCount>0&&(d.refCount-=1,d.refCount<=0&&c())}}}}();function k(a,b,c){var e=a.properties[c];if(d.l.isString(e)&&d.l.isObject(b[e]))return b[e].value}function l(a){var b=a.items,c=a.alignText;return e.createElement("div",{className:"choropleth-visualization-legend"},d.l.map(b,function(a,b){return e.createElement("div",{key:"legend".concat(b),className:"legend-item"},e.createElement("div",{className:"legend-item-text text-".concat(c)},a.text))}))}l.defaultProps={items:[],alignText:"left"};var m=g.L.Control.extend({options:{position:"topright"},onAdd:function(){var a=document.createElement("div");return a.className="leaflet-bar leaflet-custom-toolbar",a.style.background="#fff",a.style.backgroundClip="padding-box",a},onRemove:function(){f.unmountComponentAtNode(this.getContainer())}});function n(a,b){return a&&(a=g.L.latLngBounds(a[0],a[1])).isValid()?a:b&&b.isValid()?b:null}function o(a){var b,c,o,p,q,r,s,t,u,v=a.data,w=a.options,x=a.onOptionsChange,y=(0,e.useState)(null),z=(0,d.i)(y,2),A=z[0],B=z[1],C=(b=w.mapType,c=(0,e.useState)(null),p=(o=(0,d.i)(c,2))[0],q=o[1],r=(0,e.useState)(!1),s=(0,d.i)(r,2),t=s[0],u=s[1],(0,e.useEffect)(function(){var a=d.l.get(d.v,"choroplethAvailableMaps.".concat(b,".url"),void 0);if(d.l.isString(a)){u(!0);var c=!1;return j.get(a,function(){return d.k.get(a).catch(function(){return null})}).then(function(a){var b=a.data;c||(q(d.l.isObject(b)?b:null),u(!1))}),function(){c=!0,j.release(a)}}d.l.isObject(a)?(q(a),u(!1)):(q(null),u(!1))},[b]),[p,t]),D=(0,d.i)(C,1)[0],E=(0,e.useRef)();E.current=x?function(a){return x((0,d._)((0,d._)({},w),{},{bounds:a}))}:d.l.noop;var F,G,H,I,J=(F=function(){return d.l.omit(w,["bounds"])},G=[w],H=(0,e.useRef)(),I=(0,e.useMemo)(F,G),d.l.isEqual(I,H.current)||(H.current=I),H.current),K=(0,e.useState)(null),L=(0,d.i)(K,2),M=L[0],N=L[1];return(0,e.useEffect)(function(){if(A){var a=function(a,b){var c=g.L.map(a,{center:[0,0],zoom:1,zoomSnap:0,scrollWheelZoom:!1,maxBoundsViscosity:1,attributionControl:!1,fullscreenControl:!0}),j=null,o=new m,p=!1,q=function(){!function(){if(d.l.isFunction(b)){var a=c.getBounds();b([[a._southWest.lat,a._southWest.lng],[a._northEast.lat,a._northEast.lng]])}}()};c.on("focus",function(){p=!0,c.on("moveend",q)}),c.on("blur",function(){c.off("moveend",q),p=!1});var r=(0,h.o)(a,function(){c.invalidateSize(!1)});return{updateLayers:function(a,b,h){if(c.eachLayer(function(a){return c.removeLayer(a)}),c.removeControl(o),!d.l.isObject(a)||!d.l.isArray(a.features))return j=null,void c.setMaxBounds(null);var m,p,q,r=function(a,b,c){var e=d.l.uniq(d.l.filter(d.l.map(a,function(a){return k(a,b,c.targetField)}),d.l.isFinite));if(0===e.length)return{limits:[],colors:[],legend:[]};var f=Math.min(e.length,c.steps);if(1===f)return{limits:e,colors:[c.colors.max],legend:[{color:c.colors.max,limit:d.l.first(e)}]};var g=i.c.limits(e,c.clusteringMode,f-1),h=i.c.scale([c.colors.min,c.colors.max]).colors(g.length),j=d.l.map(h,function(a,b){return{color:a,limit:g[b]}}).reverse();return{limits:g,colors:h,legend:j}}(a.features,b,h),s=r.limits,t=r.colors,u=r.legend,v=(m=h.valueFormat,p=h.noValuePlaceholder,q=(0,d.b)(m),function(a){return d.l.isFinite(a)?q(a):p}),w=(j=g.L.geoJSON(a,{onEachFeature:function(a,c){var e,f,g,j,l,m,n,o,p,q,r,u,w,x,y,z,A;o=(e={feature:a,layer:c,data:b,options:h,limits:s,colors:t,formatValue:v}).feature,p=e.layer,q=e.data,r=e.options,u=e.limits,w=e.colors,x=e.formatValue,y=k(o,q,r.targetField),z=(f=o,g=x(y),j=q,l=r.targetField,m={},d.l.each(f.properties,function(a,b){m["@@"+b]=a}),m["@@value"]=g,n=j[f.properties[l]]||{},d.l.extend(m,n.item)),A=function(a,b,c,e){if(d.l.isFinite(a)){for(var f=0;f<b.length;f+=1)if(a<=b[f])return c[f]}return e}(y,u,w,r.colors.noValue),p.setStyle({color:r.colors.borders,weight:1,fillColor:A,fillOpacity:1}),r.tooltip.enabled&&p.bindTooltip((0,d.m)((0,d.f)(r.tooltip.template,z)),{sticky:!0}),r.popup.enabled&&p.bindPopup((0,d.m)((0,d.f)(r.popup.template,z))),p.on("mouseover",function(){var a;p.setStyle({weight:2,fillColor:(a=A,(0,i.c)(a).darken().hex())})}),p.on("mouseout",function(){p.setStyle({weight:1,fillColor:A})})}}).addTo(c)).getBounds(),x=n(h.bounds,w);c.fitBounds(x,{animate:!1,duration:0}),c.options.maxBounds=w,c.panInsideBounds(w,{animate:!1,duration:0}),h.legend.visible&&u.length>0&&(o.setPosition(h.legend.position.replace("-","")),c.addControl(o),f.render(e.createElement(l,{items:d.l.map(u,function(a){return(0,d._)((0,d._)({},a),{},{text:v(a.limit)})}),alignText:h.legend.alignText}),o.getContainer()))},updateBounds:function(a){p||(a=n(a,j?j.getBounds():c.getBounds()))&&c.fitBounds(a,{animate:!1,duration:0})},destroy:function(){r(),c.removeControl(o),c.remove()}}}(A,function(){return E.current.apply(E,arguments)});return N(a),function(){a.destroy()}}},[A]),(0,e.useEffect)(function(){M&&M.updateLayers(D,function(a,b,c){if(!b||!c)return{};var e={};return d.l.each(a,function(a){if(a[b]){var f=parseFloat(a[c]);e[a[b]]={code:a[b],value:d.l.isFinite(f)?f:void 0,item:a}}}),e}(v.rows,J.keyColumn,J.valueColumn),w)},[M,D,v.rows,J]),(0,e.useEffect)(function(){M&&M.updateBounds(w.bounds)},[M,w,x]),e.createElement("div",{className:"map-visualization-container",style:{background:w.colors.background},ref:B})}(0,d.s)(".choropleth-visualization-legend {\n  padding: 3px;\n  cursor: default;\n}\n.choropleth-visualization-legend > div {\n  line-height: 1;\n  margin: 5px;\n}\n.choropleth-visualization-legend .legend-item {\n  display: flex;\n  align-items: center;\n}\n.choropleth-visualization-legend .legend-item .color-swatch {\n  margin-right: 5px;\n}\n.choropleth-visualization-legend .legend-item .legend-item-text {\n  flex: 1 1 auto;\n}\n.choropleth-visualization-legend .legend-item .legend-item-text.text-left {\n  text-align: left;\n}\n.choropleth-visualization-legend .legend-item .legend-item-text.text-center {\n  text-align: center;\n}\n.choropleth-visualization-legend .legend-item .legend-item-text.text-right {\n  text-align: right;\n}\n"),o.propTypes=d.R},59826:function(a,b,c){c.d(b,{o:function(){return f}});var d=new Map;function e(){d.size>0&&(d.forEach(function(a,b){var c=b.getBoundingClientRect(),d=Math.round(10*c.width),e=Math.round(10*c.height);a.width===d&&a.height===e||(a.width=d,a.height=e,a.callback(b))}),setTimeout(e,100))}function f(a,b){if(a&&!d.has(a)){var c=0===d.size;return d.set(a,{callback:b}),c&&e(),function(){return d.delete(a)}}return function(){}}}}])