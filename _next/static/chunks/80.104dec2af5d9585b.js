"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[80],{3228:function(a,b,c){c.r(b),c.d(b,{default:function(){return l}});var d=c(8427),e=c(7294),f=c(3935);c(4124);var g=c(9826);function h(a,b,c){var e=a.properties[c];if(d.l.isString(e)&&d.l.isObject(b[e]))return b[e].value}function i(a){var b=a.items,c=a.alignText;return e.createElement("div",{className:"choropleth-visualization-legend"},d.l.map(b,function(a,b){return e.createElement("div",{key:"legend".concat(b),className:"legend-item"},e.createElement(d.o.Swatch,{color:a.color}),e.createElement("div",{className:"legend-item-text text-".concat(c)},a.text))}))}c(5078),c(7762),i.defaultProps={items:[],alignText:"left"};var j=d.L.Control.extend({options:{position:"topright"},onAdd:function(){var a=document.createElement("div");return a.className="leaflet-bar leaflet-custom-toolbar",a.style.background="#fff",a.style.backgroundClip="padding-box",a},onRemove:function(){f.unmountComponentAtNode(this.getContainer())}});function k(a,b){return a&&(a=d.L.latLngBounds(a[0],a[1])).isValid()?a:b&&b.isValid()?b:null}function l(a){var b=a.data,c=a.options,l=a.onOptionsChange,m=(0,e.useState)(null),n=(0,d._)(m,2),o=n[0],p=n[1],q=(0,d.u)(c.mapType),r=(0,d._)(q,1)[0],s=(0,e.useRef)();s.current=l?function(a){return l((0,d.b)((0,d.b)({},c),{},{bounds:a}))}:d.l.noop;var t,u,v,w,x=(t=function(){return d.l.omit(c,["bounds"])},u=[c],v=(0,e.useRef)(),w=(0,e.useMemo)(t,u),d.l.isEqual(w,v.current)||(v.current=w),v.current),y=(0,e.useState)(null),z=(0,d._)(y,2),A=z[0],B=z[1];return(0,e.useEffect)(function(){if(o){var a=function(a,b){var c=d.L.map(a,{center:[0,0],zoom:1,zoomSnap:0,scrollWheelZoom:!1,maxBoundsViscosity:1,attributionControl:!1,fullscreenControl:!0}),l=null,m=new j,n=!1,o=function(){!function(){if(d.l.isFunction(b)){var a=c.getBounds();b([[a._southWest.lat,a._southWest.lng],[a._northEast.lat,a._northEast.lng]])}}()};c.on("focus",function(){n=!0,c.on("moveend",o)}),c.on("blur",function(){c.off("moveend",o),n=!1});var p=(0,g.o)(a,function(){c.invalidateSize(!1)});return{updateLayers:function(a,b,g){if(c.eachLayer(function(a){return c.removeLayer(a)}),c.removeControl(m),!d.l.isObject(a)||!d.l.isArray(a.features))return l=null,void c.setMaxBounds(null);var j,n,o,p=function(a,b,c){var e=d.l.uniq(d.l.filter(d.l.map(a,function(a){return h(a,b,c.targetField)}),d.l.isFinite));if(0===e.length)return{limits:[],colors:[],legend:[]};var f=Math.min(e.length,c.steps);if(1===f)return{limits:e,colors:[c.colors.max],legend:[{color:c.colors.max,limit:d.l.first(e)}]};var g=d.n.limits(e,c.clusteringMode,f-1),i=d.n.scale([c.colors.min,c.colors.max]).colors(g.length),j=d.l.map(i,function(a,b){return{color:a,limit:g[b]}}).reverse();return{limits:g,colors:i,legend:j}}(a.features,b,g),q=p.limits,r=p.colors,s=p.legend,t=(j=g.valueFormat,n=g.noValuePlaceholder,o=(0,d.h)(j),function(a){return d.l.isFinite(a)?o(a):n}),u=(l=d.L.geoJSON(a,{onEachFeature:function(a,c){var e,f,i,j,k,l,m,n,o,p,s,u,v,w,x,y,z;n=(e={feature:a,layer:c,data:b,options:g,limits:q,colors:r,formatValue:t}).feature,o=e.layer,p=e.data,s=e.options,u=e.limits,v=e.colors,w=e.formatValue,x=h(n,p,s.targetField),y=(f=n,i=w(x),j=p,k=s.targetField,l={},d.l.each(f.properties,function(a,b){l["@@"+b]=a}),l["@@value"]=i,m=j[f.properties[k]]||{},d.l.extend(l,m.item)),z=function(a,b,c,e){if(d.l.isFinite(a)){for(var f=0;f<b.length;f+=1)if(a<=b[f])return c[f]}return e}(x,u,v,s.colors.noValue),o.setStyle({color:s.colors.borders,weight:1,fillColor:z,fillOpacity:1}),s.tooltip.enabled&&o.bindTooltip((0,d.p)((0,d.i)(s.tooltip.template,y)),{sticky:!0}),s.popup.enabled&&o.bindPopup((0,d.p)((0,d.i)(s.popup.template,y))),o.on("mouseover",function(){var a;o.setStyle({weight:2,fillColor:(a=z,(0,d.n)(a).darken().hex())})}),o.on("mouseout",function(){o.setStyle({weight:1,fillColor:z})})}}).addTo(c)).getBounds(),v=k(g.bounds,u);c.fitBounds(v,{animate:!1,duration:0}),c.options.maxBounds=u,c.panInsideBounds(u,{animate:!1,duration:0}),g.legend.visible&&s.length>0&&(m.setPosition(g.legend.position.replace("-","")),c.addControl(m),f.render(e.createElement(i,{items:d.l.map(s,function(a){return(0,d.b)((0,d.b)({},a),{},{text:t(a.limit)})}),alignText:g.legend.alignText}),m.getContainer()))},updateBounds:function(a){n||(a=k(a,l?l.getBounds():c.getBounds()))&&c.fitBounds(a,{animate:!1,duration:0})},destroy:function(){p(),c.removeControl(m),c.remove()}}}(o,function(){return s.current.apply(s,arguments)});return B(a),function(){a.destroy()}}},[o]),(0,e.useEffect)(function(){A&&A.updateLayers(r,function(a,b,c){if(!b||!c)return{};var e={};return d.l.each(a,function(a){if(a[b]){var f=parseFloat(a[c]);e[a[b]]={code:a[b],value:d.l.isFinite(f)?f:void 0,item:a}}}),e}(b.rows,x.keyColumn,x.valueColumn),c)},[A,r,b.rows,x]),(0,e.useEffect)(function(){A&&A.updateBounds(c.bounds)},[A,c,l]),e.createElement("div",{className:"map-visualization-container",style:{background:c.colors.background},ref:p})}(0,d.s)(".choropleth-visualization-legend {\n  padding: 3px;\n  cursor: default;\n}\n.choropleth-visualization-legend > div {\n  line-height: 1;\n  margin: 5px;\n}\n.choropleth-visualization-legend .legend-item {\n  display: flex;\n  align-items: center;\n}\n.choropleth-visualization-legend .legend-item .color-swatch {\n  margin-right: 5px;\n}\n.choropleth-visualization-legend .legend-item .legend-item-text {\n  flex: 1 1 auto;\n}\n.choropleth-visualization-legend .legend-item .legend-item-text.text-left {\n  text-align: left;\n}\n.choropleth-visualization-legend .legend-item .legend-item-text.text-center {\n  text-align: center;\n}\n.choropleth-visualization-legend .legend-item .legend-item-text.text-right {\n  text-align: right;\n}\n"),l.propTypes=d.R}}])